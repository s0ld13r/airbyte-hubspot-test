{{ config(
    indexes = [{'columns':['_airbyte_emitted_at'],'type':'btree'}],
    schema = "_airbyte_public",
    tags = [ "nested-intermediate" ]
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ ref('tickets_properties_ab2') }}
select
    {{ dbt_utils.surrogate_key([
        '_airbyte_tickets_hashid',
        'closed_date',
        'hs_all_accessible_team_ids',
        'hs_all_conversation_mentions',
        'hs_user_ids_of_all_notification_unfollowers',
        'subject',
        'createdate',
        'hs_msteams_message_id',
        'hs_inbox_id',
        'hs_lastcontacted',
        'time_to_first_agent_reply',
        'hs_originating_email_engagement_id',
        'hs_ticket_id',
        'hubspot_owner_id',
        'hs_lastactivitydate',
        'hs_object_source_id',
        'hs_created_by_user_id',
        'nps_follow_up_question_version',
        boolean_to_string('hs_in_helpdesk'),
        'hs_first_agent_message_sent_at',
        'last_engagement_date',
        boolean_to_string('hs_was_imported'),
        'hs_nextactivitydate',
        'hs_last_email_date',
        'notes_last_updated',
        'hs_primary_company_name',
        'source_ref',
        'source_type',
        'hs_conversations_originating_message_id',
        'hs_pipeline_stage',
        'created_by',
        'tags',
        'hs_ticket_priority',
        'hs_custom_inbox',
        'nps_score',
        'hs_external_object_ids',
        'first_agent_reply_date',
        'hs_num_times_contacted',
        'hs_object_id',
        'nps_follow_up_answer',
        'hs_file_upload',
        'hs_merged_object_ids',
        'hs_assignment_method',
        'last_reply_date',
        'source_thread_id',
        'hs_most_relevant_sla_status',
        'hs_sales_email_last_replied',
        'hs_updated_by_user_id',
        'hs_time_in_2',
        'hs_time_in_3',
        'hs_time_in_1',
        'hs_pipeline',
        'hs_all_team_ids',
        boolean_to_string('hs_read_only'),
        'hs_time_in_4',
        'hs_date_exited_1',
        'hs_date_exited_2',
        adapter.quote('content'),
        'hs_date_exited_3',
        'hs_primary_company',
        'hs_date_exited_4',
        'hs_last_email_activity',
        'hs_helpdesk_sort_timestamp',
        'hubspot_team_id',
        'hs_unique_creation_key',
        'hs_date_entered_4',
        'num_contacted_notes',
        'hs_primary_company_id',
        'hs_user_ids_of_all_notification_followers',
        'hs_date_entered_3',
        'hs_last_message_sent_at',
        'hs_date_entered_2',
        'hs_createdate',
        'hs_date_entered_1',
        'hs_last_message_received_at',
        'hs_thread_ids_to_restore',
        'hs_originating_generic_channel_id',
        'hs_latest_message_seen_by_agent_ids',
        'hs_all_owner_ids',
        boolean_to_string('hs_last_message_from_visitor'),
        'notes_next_activity_date',
        'hs_conversations_originating_thread_id',
        'hs_pinned_engagement_id',
        'hs_most_relevant_sla_type',
        'hs_originating_channel_instance_id',
        'hs_resolution',
        'hs_user_ids_of_all_owners',
        'hs_ticket_category',
        'hs_lastmodifieddate',
        'notes_last_contacted',
        'hubspot_owner_assigneddate',
        'hs_num_associated_companies',
        'hs_object_source',
        'hs_object_source_user_id',
        'time_to_close',
        'hs_auto_generated_from_thread_id',
        'num_notes',
    ]) }} as _airbyte_properties_hashid,
    tmp.*
from {{ ref('tickets_properties_ab2') }} tmp
-- properties at tickets/properties
where 1 = 1
{{ incremental_clause('_airbyte_emitted_at', this) }}

